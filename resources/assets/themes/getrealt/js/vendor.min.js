!function(n){n.fn.parallax=function(t){var e=n(window).height(),o=n.extend({speed:.15},t);return this.each(function(){var t=n(this);if(t.initialY=0,t[0].style.backgroundPositionY){var i=parseInt(t[0].style.backgroundPositionY);t.initialY=i||0}n(document).scroll(function(){var i=n(window).scrollTop(),r=t.offset().top;if(!(r+t.outerHeight()<=i||r>=i+e)){var u=t.initialY-Math.round((r-i)*o.speed);t.css("background-position","center "+u+"px")}})})},n(document).ready(function(){n(".parallax-heading").parallax({speed:.35})})}(jQuery),function(n,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():n.polly=t()}(this,function(){"use strict";function n(n,t){for(var e=0;;)try{return t()}catch(t){if(!(e<n.count&&n.handleFn(t)))throw t;e++}}function t(n,t){var e=0;return new Promise(function(o,i){function r(){t().then(function(n){o(n)},function(t){e<n.count&&n.handleFn(t)?(e++,r()):i(t)})}r()})}function e(n,t){return new Promise(function(e,o){function i(){t().then(function(n){e(n)},function(t){var e=n.delays.shift();e&&n.handleFn(t)?setTimeout(i,e):o(t)})}i()})}function o(n,t,e){function o(r,u){r&&i<n.count&&n.handleFn(r)?(i++,t(o)):e(r,u)}var i=0;t(o)}function i(n,t,e){function o(i,r){var u=n.delays.shift();i&&u&&n.handleFn(i)?setTimeout(function(){t(o)},u):e(i,r)}t(o)}function r(n){for(var t=[],e=u.delay,o=0;o<n;o++)t.push(e),e*=2;return t}var u={delay:100},c=function(){var c={count:1,delays:[u.delay],handleFn:function(){return!0}};return{handle:function(n){return"function"==typeof n&&(c.handleFn=n),this},retry:function(e){return"number"==typeof e&&(c.count=e),{execute:n.bind(null,c),executeForPromise:t.bind(null,c),executeForNode:o.bind(null,c)}},waitAndRetry:function(n){return"number"==typeof n&&(n=r(n)),Array.isArray(n)&&(c.delays=n),{executeForPromise:e.bind(null,c),executeForNode:i.bind(null,c)}}}};return c.defaults=u,c});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBhcmFsbGF4LmpzIiwicG9sbHkuanMiXSwibmFtZXMiOlsiJCIsImZuIiwicGFyYWxsYXgiLCJvcHRpb25zIiwid2luZG93SGVpZ2h0Iiwid2luZG93IiwiaGVpZ2h0Iiwic2V0dGluZ3MiLCJleHRlbmQiLCJzcGVlZCIsInRoaXMiLCJlYWNoIiwiJHRoaXMiLCJpbml0aWFsWSIsInN0eWxlIiwiYmFja2dyb3VuZFBvc2l0aW9uWSIsInBhcnNlZCIsInBhcnNlSW50IiwiZG9jdW1lbnQiLCJzY3JvbGwiLCJzY3JvbGxUb3AiLCJvZmZzZXQiLCJ0b3AiLCJvdXRlckhlaWdodCIsInlCZ1Bvc2l0aW9uIiwiTWF0aCIsInJvdW5kIiwiY3NzIiwicmVhZHkiLCJqUXVlcnkiLCJyb290IiwiZmFjdG9yeSIsImRlZmluZSIsImFtZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJwb2xseSIsImV4ZWN1dGUiLCJjb25maWciLCJjYiIsImNvdW50IiwiZXgiLCJoYW5kbGVGbiIsImV4ZWN1dGVGb3JQcm9taXNlIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJ0aGVuIiwiZSIsImV4ZWN1dGVGb3JQcm9taXNlV2l0aERlbGF5IiwiZGVsYXkiLCJkZWxheXMiLCJzaGlmdCIsInNldFRpbWVvdXQiLCJleGVjdXRlRm9yTm9kZSIsImNhbGxiYWNrIiwiaW50ZXJuYWxDYWxsYmFjayIsImVyciIsImRhdGEiLCJleGVjdXRlRm9yTm9kZVdpdGhEZWxheSIsImRlbGF5Q291bnRUb0RlbGF5cyIsImRlZmF1bHRzIiwiaSIsInB1c2giLCJwb2xseUZuIiwiaGFuZGxlIiwicmV0cnkiLCJiaW5kIiwid2FpdEFuZFJldHJ5IiwiQXJyYXkiLCJpc0FycmF5Il0sIm1hcHBpbmdzIjoiQ0FNQSxTQUFBQSxHQUVBQSxFQUFBQyxHQUFBQyxTQUFBLFNBQUFDLEdBRUEsR0FBQUMsR0FBQUosRUFBQUssUUFBQUMsU0FHQUMsRUFBQVAsRUFBQVEsUUFDQUMsTUFBQSxLQUNBTixFQUdBLE9B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QUE3QixHQUNBSyxrQkFBQUEsRUFBQXdCLEtBQUEsS0FBQTdCLEdBQ0FnQixlQUFBQSxFQUFBYSxLQUFBLEtBQUE3QixLQUdBOEIsYUFBQSxTQUFBakIsR0FTQSxNQVJBLGdCQUFBQSxLQUNBQSxFQUFBUyxFQUFBVCxJQUdBa0IsTUFBQUMsUUFBQW5CLEtBQ0FiLEVBQUFhLE9BQUFBLElBSUFSLGtCQUFBTSxFQUFBa0IsS0FBQSxLQUFBN0IsR0FDQWdCLGVBQUFLLEVBQUFRLEtBQUEsS0FBQTdCLE1BT0EsT0FGQTBCLEdBQUFILFNBQUFBLEVBRUFHIiwiZmlsZSI6InZlbmRvci5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEF1dGhvcjogSGVhdGhlciBDb3JleVxuICogalF1ZXJ5IFNpbXBsZSBQYXJhbGxheCBQbHVnaW5cbiAqXG4gKi9cblxuKGZ1bmN0aW9uICgkKSB7XG5cbiAgICAkLmZuLnBhcmFsbGF4ID0gZnVuY3Rpb24gKG9wdGlvbnMpIHtcblxuICAgICAgICB2YXIgd2luZG93SGVpZ2h0ID0gJCh3aW5kb3cpLmhlaWdodCgpO1xuXG4gICAgICAgIC8vIEVzdGFibGlzaCBkZWZhdWx0IHNldHRpbmdzXG4gICAgICAgIHZhciBzZXR0aW5ncyA9ICQuZXh0ZW5kKHtcbiAgICAgICAgICAgIHNwZWVkOiAwLjE1XG4gICAgICAgIH0sIG9wdGlvbnMpO1xuXG4gICAgICAgIC8vIEl0ZXJhdGUgb3ZlciBlYWNoIG9iamVjdCBpbiBjb2xsZWN0aW9uXG4gICAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAvLyBTYXZlIGEgcmVmZXJlbmNlIHRvIHRoZSBlbGVtZW50XG4gICAgICAgICAgICB2YXIgJHRoaXMgPSAkKHRoaXMpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAkdGhpcy5pbml0aWFsWSA9IDA7XG4gICAgICAgICAgICBpZiAoJHRoaXNbMF0uc3R5bGUuYmFja2dyb3VuZFBvc2l0aW9uWSkge1xuICAgICAgICAgICAgICAgIHZhciBwYXJzZWQgPSBwYXJzZUludCgkdGhpc1swXS5zdHlsZS5iYWNrZ3JvdW5kUG9zaXRpb25ZKTtcbiAgICAgICAgICAgICAgICAkdGhpcy5pbml0aWFsWSA9IChwYXJzZWQgPyBwYXJzZWQgOiAwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuXG4gICAgICAgICAgICAvLyBTZXQgdXAgU2Nyb2xsIEhhbmRsZXJcbiAgICAgICAgICAgICQoZG9jdW1lbnQpLnNjcm9sbChmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgc2Nyb2xsVG9wID0gJCh3aW5kb3cpLnNjcm9sbFRvcCgpO1xuICAgICAgICAgICAgICAgIHZhciBvZmZzZXQgPSAkdGhpcy5vZmZzZXQoKS50b3A7XG4gICAgICAgICAgICAgICAgdmFyIGhlaWdodCA9ICR0aGlzLm91dGVySGVpZ2h0KCk7XG5cbiAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiBhYm92ZSBvciBiZWxvdyB2aWV3cG9ydFxuICAgICAgICAgICAgICAgIGlmIChvZmZzZXQgKyBoZWlnaHQgPD0gc2Nyb2xsVG9wIHx8IG9mZnNldCA+PSBzY3JvbGxUb3AgKyB3aW5kb3dIZWlnaHQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciB5QmdQb3NpdGlvbiA9ICR0aGlzLmluaXRpYWxZIC0gTWF0aC5yb3VuZCgob2Zmc2V0IC0gc2Nyb2xsVG9wKSAqIHNldHRpbmdzLnNwZWVkKTtcblxuICAgICAgICAgICAgICAgIC8vIEFwcGx5IHRoZSBZIEJhY2tncm91bmQgUG9zaXRpb24gdG8gU2V0IHRoZSBQYXJhbGxheCBFZmZlY3RcbiAgICAgICAgICAgICAgICAkdGhpcy5jc3MoJ2JhY2tncm91bmQtcG9zaXRpb24nLCAnY2VudGVyICcgKyB5QmdQb3NpdGlvbiArICdweCcpO1xuXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgICQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgJCgnLnBhcmFsbGF4LWhlYWRpbmcnKS5wYXJhbGxheCh7XG4gICAgICAgICAgICBzcGVlZCA6IDAuMzVcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbn0oalF1ZXJ5KSk7XG4iLCIvKipcbiAqIENyZWF0ZWQgYnkgbWF1cmljZSBvbiA5LzE3LzIwMTUuXG4gKiBodHRwczovL2dpdGh1Yi5jb20vbWF1cmljZWRiL3BvbGx5LWpzXG4gKi9cblxuKGZ1bmN0aW9uIChyb290LCBmYWN0b3J5KSB7XG4gICAgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkge1xuICAgICAgICAvLyBBTUQuIFJlZ2lzdGVyIGFzIGFuIGFub255bW91cyBtb2R1bGUuXG4gICAgICAgIGRlZmluZShbXSwgZmFjdG9yeSk7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgLy8gTm9kZS4gRG9lcyBub3Qgd29yayB3aXRoIHN0cmljdCBDb21tb25KUywgYnV0XG4gICAgICAgIC8vIG9ubHkgQ29tbW9uSlMtbGlrZSBlbnZpcm9ubWVudHMgdGhhdCBzdXBwb3J0IG1vZHVsZS5leHBvcnRzLFxuICAgICAgICAvLyBsaWtlIE5vZGUuXG4gICAgICAgIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIEJyb3dzZXIgZ2xvYmFscyAocm9vdCBpcyB3aW5kb3cpXG4gICAgICAgIHJvb3QucG9sbHkgPSBmYWN0b3J5KCk7XG4gICAgfVxufSh0aGlzLCBmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgdmFyIGRlZmF1bHRzID0ge1xuICAgICAgICBkZWxheTogMTAwXG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIGV4ZWN1dGUoY29uZmlnLCBjYikge1xuICAgICAgICB2YXIgY291bnQgPSAwO1xuXG4gICAgICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHJldHVybiBjYigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGV4KSB7XG4gICAgICAgICAgICAgICAgaWYgKGNvdW50IDwgY29uZmlnLmNvdW50ICYmIGNvbmZpZy5oYW5kbGVGbihleCkpIHtcbiAgICAgICAgICAgICAgICAgICAgY291bnQrKztcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBleDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBleGVjdXRlRm9yUHJvbWlzZShjb25maWcsIGNiKSB7XG4gICAgICAgIHZhciBjb3VudCA9IDA7XG5cbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgIGZ1bmN0aW9uIGV4ZWN1dGUoKSB7XG4gICAgICAgICAgICAgICAgdmFyIG9yaWdpbmFsID0gY2IoKTtcblxuICAgICAgICAgICAgICAgIG9yaWdpbmFsLnRoZW4oZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShlKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoY291bnQgPCBjb25maWcuY291bnQgJiYgY29uZmlnLmhhbmRsZUZuKGUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb3VudCsrO1xuICAgICAgICAgICAgICAgICAgICAgICAgZXhlY3V0ZSgpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZXhlY3V0ZSgpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBleGVjdXRlRm9yUHJvbWlzZVdpdGhEZWxheShjb25maWcsIGNiKSB7XG5cbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgIGZ1bmN0aW9uIGV4ZWN1dGUoKSB7XG4gICAgICAgICAgICAgICAgdmFyIG9yaWdpbmFsID0gY2IoKTtcblxuICAgICAgICAgICAgICAgIG9yaWdpbmFsLnRoZW4oZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShlKTtcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZGVsYXkgPSBjb25maWcuZGVsYXlzLnNoaWZ0KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGRlbGF5ICYmIGNvbmZpZy5oYW5kbGVGbihlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChleGVjdXRlLCBkZWxheSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBleGVjdXRlKCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuXG4gICAgZnVuY3Rpb24gZXhlY3V0ZUZvck5vZGUoY29uZmlnLCBmbiwgY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIGNvdW50ID0gMDtcblxuICAgICAgICBmdW5jdGlvbiBpbnRlcm5hbENhbGxiYWNrKGVyciwgZGF0YSkge1xuICAgICAgICAgICAgaWYgKGVyciAmJiBjb3VudCA8IGNvbmZpZy5jb3VudCAmJiBjb25maWcuaGFuZGxlRm4oZXJyKSkge1xuICAgICAgICAgICAgICAgIGNvdW50Kys7XG4gICAgICAgICAgICAgICAgZm4oaW50ZXJuYWxDYWxsYmFjayk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKGVyciwgZGF0YSk7XG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZuKGludGVybmFsQ2FsbGJhY2spO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGV4ZWN1dGVGb3JOb2RlV2l0aERlbGF5KGNvbmZpZywgZm4sIGNhbGxiYWNrKSB7XG5cbiAgICAgICAgZnVuY3Rpb24gaW50ZXJuYWxDYWxsYmFjayhlcnIsIGRhdGEpIHtcbiAgICAgICAgICAgIHZhciBkZWxheSA9IGNvbmZpZy5kZWxheXMuc2hpZnQoKTtcbiAgICAgICAgICAgIGlmIChlcnIgJiYgZGVsYXkgJiYgY29uZmlnLmhhbmRsZUZuKGVycikpIHtcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgZm4oaW50ZXJuYWxDYWxsYmFjayk7XG4gICAgICAgICAgICAgICAgfSwgZGVsYXkpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjYWxsYmFjayhlcnIsIGRhdGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZm4oaW50ZXJuYWxDYWxsYmFjayk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZGVsYXlDb3VudFRvRGVsYXlzKGNvdW50KSB7XG4gICAgICAgIHZhciBkZWxheXMgPSBbXSwgZGVsYXkgPSBkZWZhdWx0cy5kZWxheTtcblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvdW50OyBpKyspIHtcbiAgICAgICAgICAgIGRlbGF5cy5wdXNoKGRlbGF5KTtcbiAgICAgICAgICAgIGRlbGF5ID0gMiAqIGRlbGF5O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGRlbGF5cztcbiAgICB9XG5cbiAgICB2YXIgcG9sbHlGbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGNvbmZpZyA9IHtcbiAgICAgICAgICAgIGNvdW50OiAxLFxuICAgICAgICAgICAgZGVsYXlzOiBbZGVmYXVsdHMuZGVsYXldLFxuICAgICAgICAgICAgaGFuZGxlRm46IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgaGFuZGxlOiBmdW5jdGlvbiAoaGFuZGxlRm4pIHtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGhhbmRsZUZuID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbmZpZy5oYW5kbGVGbiA9IGhhbmRsZUZuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJldHJ5OiBmdW5jdGlvbiAoY291bnQpIHtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGNvdW50ID09PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgICAgICAgICBjb25maWcuY291bnQgPSBjb3VudDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBleGVjdXRlOiBleGVjdXRlLmJpbmQobnVsbCwgY29uZmlnKSxcbiAgICAgICAgICAgICAgICAgICAgZXhlY3V0ZUZvclByb21pc2U6IGV4ZWN1dGVGb3JQcm9taXNlLmJpbmQobnVsbCwgY29uZmlnKSxcbiAgICAgICAgICAgICAgICAgICAgZXhlY3V0ZUZvck5vZGU6IGV4ZWN1dGVGb3JOb2RlLmJpbmQobnVsbCwgY29uZmlnKVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgd2FpdEFuZFJldHJ5OiBmdW5jdGlvbiAoZGVsYXlzKSB7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBkZWxheXMgPT09ICdudW1iZXInKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlbGF5cyA9IGRlbGF5Q291bnRUb0RlbGF5cyhkZWxheXMpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KGRlbGF5cykpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uZmlnLmRlbGF5cyA9IGRlbGF5cztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBleGVjdXRlRm9yUHJvbWlzZTogZXhlY3V0ZUZvclByb21pc2VXaXRoRGVsYXkuYmluZChudWxsLCBjb25maWcpLFxuICAgICAgICAgICAgICAgICAgICBleGVjdXRlRm9yTm9kZTogZXhlY3V0ZUZvck5vZGVXaXRoRGVsYXkuYmluZChudWxsLCBjb25maWcpXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9O1xuICAgIHBvbGx5Rm4uZGVmYXVsdHMgPSBkZWZhdWx0cztcblxuICAgIHJldHVybiBwb2xseUZuO1xufSkpOyJdfQ==
